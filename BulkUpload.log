-- 1. Get UserIds
select userID from auth.dbo.users WITH (NOLOCK) where createDT='2023-01-03' and username like 'SIGNIFYHEALTHUSER%';

-- 2. complete training
update auth.dbo.users WITH (ROWLOCK) set completedTraining=1, lastActivityDT='2023-12-31', lastLoginDT='2023-12-31' where createDT='2023-01-03' and username like 'SIGNIFYHEALTHUSER%';

-- 3. Get CenterID
select centerID from outcomes.dbo.pharmacy WITH (NOLOCK) where NCPDP_NABP='99B360';

------------------------------------------------------------------------------------
-------------------------------Update Lastlogindate and  Last Activity date ---------

update auth.dbo.users WITH (ROWLOCK) set lastActivityDT='2023-12-31', lastLoginDT='2023-12-31' where username like 'SIGNIFYHEALTHUSER%';

select count(*) from auth.dbo.users with (NOLOCK) where username like 'SIGNIFYHEALTHUSER%';

---------------------------------------------------------------------------------------------------------------------------------------------------------

-- 4. bulk update user center by query



------------------------------------------- User Rec -----------------------------------------
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498937,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498938,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498939,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498940,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498941,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498942,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498943,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498944,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498945,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498946,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498947,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498948,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498949,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498950,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498951,193003,'2023-01-03', 1,'2023-01-03',1,1);
insert into outcomes.dbo.userCenter WITH (ROWLOCK) (userID,centerID,requestDT,approved,approvedDT,active,selected) values (498952,193003,'2023-01-03', 1,'2023-01-03',1,1);



======================================

select * from outcomes.dbo.contact with (NOLOCK) where userID in (select userID from auth.dbo.users where username like 'SIGNIFYHEALTHUSER%');

update auth.dbo.users WITH (ROWLOCK) set lastActivityDT='2023-12-31', lastLoginDT='2023-12-31' where username like 'SIGNIFYHEALTHUSER%';

update outcomes.dbo.contact with (ROWLOCK) set email= 'GMB-SignifyHealthUsers@getoutcomes.com' where userID in (select userID from auth.dbo.users where username like 'SIGNIFYHEALTHUSER%');


=========================
update outcomes.dbo.userCenter WITH (ROWLOCK) set centerID = (select centerID from outcomes.dbo.pharmacy WITH (NOLOCK) where NCPDP_NABP='19693344')  
where centerID = (select centerID from outcomes.dbo.pharmacy WITH (NOLOCK) where NCPDP_NABP='1580859088') and userID = (select userID from
auth.dbo.users where username = 'test.emily.test');
